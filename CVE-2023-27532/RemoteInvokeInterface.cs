using System.Runtime.Serialization;
using System.ServiceModel;
using System.Data;

namespace CVE_2023_27532;

[DataContract(Name = "InvokeScope")]
public enum ERemoteInvokeScope
{
    [EnumMember] DatabaseManager,
    [EnumMember] DatabaseAccessor,
}

[DataContract(Name = "InvokeMethod")]
public enum ERemoteInvokeMethod
{
    [EnumMember] CredentialsDbScopeFindCredentials,
    [EnumMember] CredentialsDbScopeGetAllCreds,
    [EnumMember] GetDataTable,
}

[ServiceContract(Name = "IRemoteInvokeService")]
public interface IRemoteInvokeService
{
    [OperationContract]
    string Invoke(ERemoteInvokeScope scope, ERemoteInvokeMethod method, string parameters);

    [OperationContract]
    DataTable GetDataTable(ERemoteInvokeScope scope, ERemoteInvokeMethod method, string spec);
}